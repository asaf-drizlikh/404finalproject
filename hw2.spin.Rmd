
```{r }
(rm(list=ls()))

zipCodes <- read.csv("zip_codes.csv")

load("HW1Data(1).Rdata")

Oklahoma[1:3,]

HSindices = grep(" HS", Oklahoma$School)
OklahomaHS <- Oklahoma[HSindices,]

structure(zipCodes)

zipIndices = grep('OK', zipCodes$state)

zipOK = zipCodes[zipIndices,]

zipOK = as.data.frame(zipOK[,c('zip','primary_city','county','estimated_population')])

names(zipOK)[2] <- "MailCity"

zipOK$MailCity <- toupper(zipOK[,"MailCity"])

OKHSzips <- merge(zipOK, OklahomaHS, all = TRUE)

dim(OKHSzips)

OKHSzips[1:3,]

uniqueSchools <- (!duplicated(OKHSzips$School))
uniqueOKHS <- OKHSzips[uniqueSchools,]

structure(uniqueOKHS)

#remove duplicate columns
uniqueOKHS <- subset(uniqueOKHS, select = -LocCity)
uniqueOKHS <- subset(uniqueOKHS, select = -County)

teachAsec <- uniqueOKHS[order(uniqueOKHS$Teachers),]

teachDesc <- uniqueOKHS[order(-uniqueOKHS$Teachers),]

teachAsec <- teachAsec[1:25,]
teachDesc <- teachDesc[1:25,]

OklahomaHSTeachers <- merge(teachAsec, teachDesc, all = TRUE)
time <- Sys.time()
time <- toString(time)
filename <- paste(c('OklahomaHSTeachers', time), sep = "-", collapse = " ")

write.csv(OklahomaHSTeachers, file = "OklahomaHSTeachers 2017-09-28 15-57-44")
```


---
title: "hw2.R"
author: "Asaf Drizlikh"
date: "Mon Nov 20 18:15:35 2017"
---
